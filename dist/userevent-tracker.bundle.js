!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports["userevent-tracker"]=t():e["userevent-tracker"]=t()}(self,(()=>(()=>{"use strict";var e={d:(t,n)=>{for(var r in n)e.o(n,r)&&!e.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:n[r]})},o:(e,t)=>Object.prototype.hasOwnProperty.call(e,t),r:e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})}},t={};e.r(t),e.d(t,{ElementType:()=>o,EventActionType:()=>r,TargetView:()=>n,debugConsole:()=>a,storeUtil:()=>i,tracker:()=>f,util:()=>c});var n="view",r={load:"load",unload:"unload",click:"click"},o={BUTTON:"BUTTON",IMG:"IMG",btn:"btn",track:"track",title:"title"},a=function(e){return void 0===e&&(e=!1),e?function(){for(var e=[],t=0;t<arguments.length;t++)e[t]=arguments[t];console.log.apply(console,e)}:function(){}},i={setTrackData:function(e){localStorage.setItem("td",JSON.stringify(e))},getTrackData:function(){return JSON.parse(localStorage.getItem("td")||"[]")},clearTrackData:function(){localStorage.removeItem("td")}},c={delay:function(e){return new Promise((function(t){var n=setTimeout((function(){t(),clearTimeout(n)}),e)}))},getCurrentDate:function(){var e=new Date;return Date.parse("".concat(e))},getDateDifference:function(e,t){var n=new Date(e),r=new Date(t);return Math.round((r.getTime()-n.getTime())/1e3)},getQueryParam:function(e){return new URLSearchParams(window.location.search).get(e)},browserInfo:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("trident")?"IE":-1!=e.indexOf("chrome")?"chrome":-1!=e.indexOf("safari")?"safari":-1!=e.indexOf("firefox")?"firefox":-1!=e.indexOf("edge")?"edge":-1!=e.indexOf("opr")?"opera":void 0},getOSInfo:function(){var e=navigator.userAgent.toLowerCase();return-1!=e.indexOf("mac")?"mac":-1!=e.indexOf("win")?"window":-1!=e.indexOf("lin")?"linux":void 0},contains:function(e,t){var n,r;return null!==(r=null===(n=null==e?void 0:e.toUpperCase())||void 0===n?void 0:n.includes(null==t?void 0:t.toUpperCase()))&&void 0!==r&&r},generateUUID:function(){return Math.random().toString(16).slice(2)}},u=function(){return u=Object.assign||function(e){for(var t,n=1,r=arguments.length;n<r;n++)for(var o in t=arguments[n])Object.prototype.hasOwnProperty.call(t,o)&&(e[o]=t[o]);return e},u.apply(this,arguments)},l=function(e,t,n){if(n||2===arguments.length)for(var r,o=0,a=t.length;o<a;o++)!r&&o in t||(r||(r=Array.prototype.slice.call(t,0,o)),r[o]=t[o]);return e.concat(r||Array.prototype.slice.call(t))},f=function(e){var t,f,s=null!==(t=null==e?void 0:e.customUUID)&&void 0!==t?t:c.generateUUID(),d=a(null==e?void 0:e.showConsole);c.delay(500).then((function(){var e,t,n,r;e=void 0,t=void 0,r=function(){return function(e,t){var n,r,o,a,i={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:c(0),throw:c(1),return:c(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a;function c(c){return function(u){return function(c){if(n)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(i=0)),i;)try{if(n=1,r&&(o=2&c[0]?r.return:c[0]?r.throw||((o=r.return)&&o.call(r),0):r.next)&&!(o=o.call(r,c[1])).done)return o;switch(r=0,o&&(c=[2&c[0],o.value]),c[0]){case 0:case 1:o=c;break;case 4:return i.label++,{value:c[1],done:!1};case 5:i.label++,r=c[1],c=[0];continue;case 7:c=i.ops.pop(),i.trys.pop();continue;default:if(!((o=(o=i.trys).length>0&&o[o.length-1])||6!==c[0]&&2!==c[0])){i=0;continue}if(3===c[0]&&(!o||c[1]>o[0]&&c[1]<o[3])){i.label=c[1];break}if(6===c[0]&&i.label<o[1]){i.label=o[1],o=c;break}if(o&&i.label<o[2]){i.label=o[2],i.ops.push(c);break}o[2]&&i.ops.pop(),i.trys.pop();continue}c=t.call(e,i)}catch(e){c=[6,e],r=0}finally{n=o=0}if(5&c[0])throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}([c,u])}}}(this,(function(e){return d("[Tracker] init"),f=i.getTrackData(),d("[Tracker] start tracking",{eventList:f}),document.onclick=g,v(window.location.pathname,!0),window.onbeforeunload=function(){return v(window.location.pathname,!1)},p(),[2]}))},new((n=void 0)||(n=Promise))((function(o,a){function i(e){try{u(r.next(e))}catch(e){a(e)}}function c(e){try{u(r.throw(e))}catch(e){a(e)}}function u(e){var t;e.done?o(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(i,c)}u((r=r.apply(e,t||[])).next())}))}));var p=function(){var e=window.location.pathname;new MutationObserver((function(){var t=window.location.pathname;t!==e&&(d("[tracker] url change",{oldUrl:e,newUrl:t}),v(e,!1),v(t,!0),e=t)})).observe(document,{subtree:!0,childList:!0})},v=function(e,t){var o={url:e,time:c.getCurrentDate(),action:t?r.load:r.unload,target:n,uuid:s};t&&(o=u(u({},o),{referrer:document.referrer,os:c.getOSInfo(),browserInfo:c.browserInfo()})),f=l(l([],f,!0),[o],!1),i.setTrackData(f)},g=function(e){var t,n=e.composedPath();if(t=m(n)){var o=w(t);d("[Tracker] data : ",{trackData:o,element:t},c.getCurrentDate()),""===o&&void 0===o||(f=l(l([],f,!0),[{url:window.location.pathname,time:c.getCurrentDate(),action:r.click,target:t.localName,data:o,uuid:s}],!1),i.setTrackData(f))}},m=function(e){for(var t=0;t<e.length;t++){var n=e[t];if(n.tagName===o.BUTTON||c.contains("".concat(n.className),o.btn)||c.contains("".concat(n.className),o.track)||n.tagName===o.IMG)return n}},w=function(e){if(e.tagName===o.IMG)return e.alt;for(var t=e.attributes,n=0;n<t.length;n++)if(t[n].name===o.title)return t[n].value;return""===e.innerText?e.type:e.innerText}};return t})()));